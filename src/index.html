<!DOCTYPE html>
<html>
    <script>
        const bodies = fetch('bodies.json').then((res) => res.json());
        const driver = fetch('driver.json').then((res) => res.json());
        const driverModel = fetch('driverModel.json').then((res) => res.json());
        const gliders = fetch('gliders.json').then((res) => res.json());
        const tires = fetch('tires.json').then((res) => res.json());
        const tracks = fetch('MarioKart8Tracks.json').then((res) => res.json());

        function flattenTracks(tracks) {
            let flatTracks = {};
            
            Object.keys(tracks).map((set) => {
                Object.keys(tracks[set]).map((cup) => {
                    flatTracks = {
                        ...flatTracks,
                        ...tracks[set][cup],
                    };
                });
            });
            return flatTracks;
        }

        function convertToOptions(source, destination) {
            for (let i = 0; i < source.length; i++) {
                let el = document.createElement('option');
                el.value = source[i].name;
                el.textContent = source[i].name;
                destination.appendChild(el);
            }
        }

        Promise.all([bodies, driver, driverModel, gliders, tires, tracks])
            .then(([bodies, driver, driverModel, gliders, tires, tracks]) => {
                let flatTracks = flattenTracks(tracks);
                let trackName = document.querySelector('#track-name');
                let character = document.querySelector('#character');
                let body = document.querySelector('#body');
                let tire = document.querySelector('#tire');
                let glider = document.querySelector('#glider');
                let previous = document.querySelector('#previous');
                let next = document.querySelectorAll('#next');

                trackName.textContent = flatTracks.Track1;
                convertToOptions(driver, character);
                convertToOptions(bodies, body);
                convertToOptions(tires, tire);
                convertToOptions(gliders, glider);
            });

    </script>
    <body>
        <h1 id="track-name">Track Name</h1>
        <select id="character">
        </select>
        <select id="body">
        </select>
        <select id="tire">
        </select>
        <select id="glider">
        </select>
        <br />
        <button id="previous">Previous</button>
        <button id="next">Next</button>
    </body>
</html>